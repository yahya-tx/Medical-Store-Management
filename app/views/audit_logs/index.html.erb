<h1>Audit Logs</h1>

<table class="table">
  <thead>
    <tr>
      <th>Cashier Name</th>
      <th>Total Sales</th>
      <th>Total Amount</th>
      <th>Total Medicines Sold</th>
      <th>Audited From</th>
      <th>Audited To</th>
      <th>Medicine Details</th>
      <th>Actions</th>
    </tr>
  </thead>
  <tbody>
    <% @audit_logs.each do |audit_log| %>
      <tr>
        <td><%= audit_log.description %></td>
        <td><%= audit_log.total_records_count %></td>
        <td><%= audit_log.total_amount %> Rs</td>
        <td><%= audit_log.total_medicines_sold %></td>
        <td><%= audit_log.audited_from.strftime('%d %b %Y') %></td>
        <td><%= audit_log.audited_to.strftime('%d %b %Y') %></td>
        <td>
          <% if audit_log.medicine_details.present? %>
            <table class="table table-bordered">
              <thead>
                <tr>
                  <th>Medicine Name</th>
                  <th>Quantity Sold</th>
                </tr>
              </thead>
              <tbody>
                <% audit_log.medicine_details.each do |medicine| %>
                  <tr>
                    <td><%= medicine['name'] %></td>
                    <td><%= medicine['quantity'] %></td>
                  </tr>
                <% end %>
              </tbody>
            </table>
          <% else %>
            No details available
          <% end %>
        </td>
        <td>
          <%= link_to 'Show', branch_audit_log_path(@branch, audit_log), class: 'btn btn-info' %>
          <%= link_to 'Delete', branch_audit_log_path(@branch, audit_log), method: :delete, data: { turbo_method: :delete, confirm: 'Are you sure you want to delete this audit log?' }, class: 'btn btn-danger' %>
        </td>
      </tr>
    <% end %>
  </tbody>
</table>

<%= link_to 'Back to Home', root_path, class: 'btn btn-secondary' %>
